'use strict';function d(m){let e={},b=new WeakMap;function i(n){return n.join(".")}function o(n,r=[]){if(n&&typeof n=="object"){if(b.has(n))return e[i(r)]=["Ref",i(b.get(n))],null;b.set(n,r);}if(n===void 0)return e[i(r)]=["Undefined"],null;if(typeof n=="number")return Number.isNaN(n)?(e[i(r)]=["NaN"],null):n===1/0?(e[i(r)]=["Infinity"],null):n===-1/0?(e[i(r)]=["-Infinity"],null):Object.is(n,-0)?(e[i(r)]=["-0"],0):n;if(typeof n=="bigint")return e[i(r)]=["BigInt"],n.toString();if(typeof n=="symbol")return e[i(r)]=["Symbol"],n.description??"";if(n instanceof Date)return e[i(r)]=["Date"],n.toISOString();if(n instanceof RegExp)return e[i(r)]=["RegExp"],n.toString();if(n instanceof Set)return e[i(r)]=["Set"],Array.from(n).map((c,t)=>o(c,[...r,String(t)]));if(n instanceof Map)return e[i(r)]=["Map"],Array.from(n.entries()).map(([c,t],f)=>[o(c,[...r,"k",String(f)]),o(t,[...r,"v",String(f)])]);if(Array.isArray(n))return n.map((c,t)=>o(c,[...r,String(t)]));if(n&&typeof n=="object"){let c={};for(let[t,f]of Object.entries(n))c[t]=o(f,[...r,t]);return c}return n}let y=o(m);return Object.keys(e).length?{json:y,meta:{values:e,v:1}}:{json:y}}function a(m){let{json:e,meta:b}=m,i=b?.values??{},o=new Map;function y(n,r){let c=i[r];if(c){let[t,f]=c;switch(t){case "Ref":return o.get(f);case "Undefined":return;case "NaN":return NaN;case "Infinity":return 1/0;case "-Infinity":return  -1/0;case "-0":return  -0;case "BigInt":return BigInt(n);case "Date":return new Date(n);case "Symbol":return Symbol(n);case "RegExp":{let s=n.lastIndexOf("/"),g=n.slice(1,s),S=n.slice(s+1);return new RegExp(g,S)}case "Set":{let s=new Set(n.map((g,S)=>y(g,r?`${r}.${S}`:`${S}`)));return o.set(r,s),s}case "Map":{let s=new Map(n.map(([g,S],u)=>[y(g,`${r}.k.${u}`),y(S,`${r}.v.${u}`)]));return o.set(r,s),s}}}if(Array.isArray(n)){let t=n.map((f,s)=>y(f,r?`${r}.${s}`:`${s}`));return o.set(r,t),t}if(n&&typeof n=="object"){let t={};o.set(r,t);for(let[f,s]of Object.entries(n)){let g=r?`${r}.${f}`:f;t[f]=y(s,g);}return t}return n}return y(e,"")}function T(m){return JSON.stringify(d(m))}function w(m){return a(JSON.parse(m))}exports.deserialize=a;exports.parse=w;exports.serialize=d;exports.stringify=T;//# sourceMappingURL=index.cjs.map
//# sourceMappingURL=index.cjs.map